<!DOCTYPE html>
<html>
<head>
    <title>ExtendScript Test</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #2b2b2b; color: #e0e0e0; }
        .log { background: #1e1e1e; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { color: #4ec9b0; }
        .error { color: #f48771; }
    </style>
</head>
<body>
    <h1>ExtendScript Loading Test</h1>
    <div id="output"></div>

    <script src="js/CSInterface.js"></script>
    <script>
        var output = document.getElementById('output');

        function log(msg, type) {
            output.innerHTML += '<div class="log ' + (type || '') + '">' + msg + '</div>';
            console.log(msg);
        }

        try {
            var cs = new CSInterface();
            log('✓ CSInterface loaded', 'success');

            var extPath = cs.getSystemPath(SystemPath.EXTENSION);
            log('Extension path: ' + extPath);

            var jsxPath = extPath + '/jsx/host.jsx';
            log('JSX path: ' + jsxPath);

            cs.evalScript('$.evalFile("' + jsxPath + '")', function(result) {
                log('evalFile result: ' + (result || 'undefined'));

                cs.evalScript('typeof EAVIngest', function(typeCheck) {
                    if (typeCheck === 'object') {
                        log('✓ EAVIngest loaded successfully!', 'success');

                        cs.evalScript('EAVIngest.getAllProjectClips()', function(clips) {
                            log('getAllProjectClips result: ' + clips);
                        });
                    } else {
                        log('✗ EAVIngest NOT loaded (type: ' + typeCheck + ')', 'error');
                    }
                });
            });
        } catch (e) {
            log('✗ Error: ' + e.message, 'error');
        }
    </script>
</body>
</html>
